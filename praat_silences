#reads several files and extracts all sileneces
#saves silences in text file (one for each recording)


dir$ = "U:\CLINT\Datenanalyse\silences_to_analyse" 
strings = Create Strings as file list: "list", dir$ +"/*.wav"
numberOfFiles = Get number of strings

#load all files
for file from 1 to numberOfFiles
 selectObject: strings
 fileName$ = Get string: file
 Read from file: dir$+"/"+fileName$
 sound$ = selected$("Sound", 1)
 To Intensity: 100, 0.001, "yes"
 Rename: "intensity"
 #-35= max silence intensity in db, 0.1 = minimum silent interval, 0.05 = min sounding interval
 textgrid=To TextGrid (silences): -25, 0.40, 0.05, "silent", "sounding"

 #headings for silence file
 writeFileLine: "silences_"+fileName$+".txt", "recording", tab$, "intervalNumber", tab$, "text", tab$, "startTs", tab$, "endTs", newline$
 #looping through intervals
 numberOfIntervals = Get number of intervals: 1
 for intervalNumber from 1 to numberOfIntervals
  #selectObject: textgrid
  startTs = Get start point: 1, intervalNumber
  endTs = Get end point: 1, intervalNumber
  text$ = Get label of interval: 1, intervalNumber
  appendFile: "silences_"+fileName$+".txt", fileName$, tab$, intervalNumber, tab$, text$, tab$, startTs, tab$, endTs, newline$
 endfor

 removeObject: textgrid

 #extract pitch and intensity, does not work: in time steps of 0.1 seconds
 #headings for pitch and intensity file
 #writeFileLine: "pitch_"+fileName$+".txt", "recording", tab$, "time", tab$, "f0", tab$, "intensity", newline$
  
 #select Sound 'sound$'
 #To Pitch: 0.001, 75, 600
 #Rename: "pitch"
 #startTs = Get start time
 #writeInfoLine: startTs
 #endTs = Get end time
 #appendInfoLine: endTs
 #intervals = (endTs - startTs)/0.01
 #appendInfoLine: intervals
 #select Sound 'sound$'
 #for j from 1 to intervals
  #time = startTs + j*0.01
  #appendInfoLine: time
  #selectObject: "Pitch pitch"
  #pitch = Get value at time: time, "Hertz", "Linear"
  #selectObject: "Intensity intensity"
  #intensity = Get value at time: time, "Cubic"
  #appendFile: "pitch_"+fileName$+".txt", fileName$, tab$, time, tab$, pitch, tab$, intensity, newline$
 
 #endfor 
 #removeObject: intensity, pitch, fileID

endfor









